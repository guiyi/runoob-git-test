<p><br />![fig:DSCF5611.JPG](https://github.com/DFRobot/DFRobotDocument/Audio_Analyzer_(SKU:DFR0126)/image/DSCF5611.JPG  "DSCF5611.JPG")===Sample code===Arduino IDE Sample code</p>
<pre class="sourceCode cpp"><code class="sourceCode cpp"><span class="ot">#include &lt;AudioAnalyzer.h&gt;</span><span class="co">//Version 1.2 for Spectrum analyzerAnalyzer Audio = Analyzer(4,5,0);//Strobe pin -&gt;4  RST pin -&gt;5 Analog Pin -&gt;0//Analyzer Audio = Analyzer();//Strobe-&gt;4 RST-&gt;5 Analog-&gt;5int FreqVal[7];//void setup(){  Serial.begin(57600); //Init the baudrate  Audio.Init();//Init module }void loop(){  Audio.ReadFreq(FreqVal);//return 7 value of 7 bands pass filiter                           //Frequency(Hz):63  160  400  1K  2.5K  6.25K  16K                          //FreqVal[]:      0    1    2    3    4    5    6    for(int i=0;i&lt;7;i++)              {    Serial.print(max((FreqVal[i]-100),0));//Transimit the DC value of the seven bands    if(i&lt;6)  Serial.print(&quot;,&quot;);    else Serial.println();  }  delay(20);}</span></code></pre>
<p>CVAVR Code:<br /><br />using atmega128 (clock 16Mhz), usart0 (9600 baud rate), timer1 (scale clock 1024), adc.formula timer1 when use clock freq 16Mhz<br /><br />Ttimer1 = Periode Timer1<br />TCNT1 = Register Timer1<br />N = Scale clock (1, 8, 64, 256 dan 1024)<br />Tosc = Periode clock<br />Fosc = Frekuensi clock cristal<br /><br />Tosc = 1/Fosc<br />Tosc = 1/16Mhz = 0,0000000625<br /><br />Ttimer1 = Tosc * (65536 - TCNT1) * N<br />1 (second) = 0,0000000625 * (65536 - TCNT1) * 1024<br />TCNT1 = 49911<br />TCNT1 = C2F7 (in hex) &lt;-- this use in //Timer 1 overflow interrupt service routine<br /><br />Clock value = Fosc/N<br />Clock value = 16Mhz/1024 = 15,625 kHz &lt;-- this use in clock value timer1<br /><br />Can use timer0 or other timer with each formula<br /><br /></p>
<pre class="sourceCode cpp"><code class="sourceCode cpp"><span class="co">/*****************************************************Chip type           : ATmega128Program type        : ApplicationClock frequency     : 16,000000 MHzMemory model        : SmallExternal SRAM size  : 0Data Stack size     : 1024*****************************************************/</span><span class="dt">int</span> sec, band, freq[<span class="dv">7</span>], i;<span class="dt">unsigned</span> <span class="dt">long</span> <span class="dt">int</span> time_a, time_b;<span class="dt">int</span> stat = <span class="dv">0</span>;#include &lt;mega128.h&gt;#include &lt;stdio.h&gt;#include &lt;delay.h&gt;<span class="co">// Timer 1 overflow interrupt service routineinterrupt [TIM1_OVF] void timer1_ovf_isr(void){// Reinitialize Timer 1 valueTCNT1H=0xC2F7 &gt;&gt; 8;TCNT1L=0xC2F7 &amp; 0xff;// Place your code heresec++;}#define ADC_VREF_TYPE 0x40// Read the AD conversion resultunsigned int read_adc(unsigned char adc_input){ADMUX=adc_input | (ADC_VREF_TYPE &amp; 0xff);// Delay needed for the stabilization of the ADC input voltagedelay_us(10);// Start the AD conversionADCSRA|=0x40;// Wait for the AD conversion to completewhile ((ADCSRA &amp; 0x10)==0);ADCSRA|=0x10;return ADCW;}void RstModule(){PORTD.0 = 0; //S LowPORTD.1 = 1; //R HighPORTD.0 = 1; //S HighPORTD.0 = 0; //S LowPORTD.1 = 0; //R Lowdelay_us(72);}void Init(){            DDRD.0 = 1; //S pinDDRD.1 = 1; //R pinRstModule();}void ReadFreq(int *value){if (stat == 0) {   time_a = sec;   stat = 1;} else if (stat == 1) {   time_b = sec;   if (time_b - time_a &gt; 3) {      RstModule();      stat = 0;   }}for (band=0;band&lt;7;band++) {   delay_us(10);   value[band] = read_adc(0);   delay_us(50);   PORTD.0 = 1; //S High   delay_us(18);   PORTD.0 = 0; //S Low}}void main(void){// Timer/Counter 1 initialization// Clock source: System Clock// Clock value: 15,625 kHz// Mode: Normal top=FFFFh// OC1A output: Discon.// OC1B output: Discon.// OC1C output: Discon.// Noise Canceler: Off// Input Capture on Falling Edge// Timer 1 Overflow Interrupt: On// Input Capture Interrupt: Off// Compare A Match Interrupt: Off// Compare B Match Interrupt: Off// Compare C Match Interrupt: OffTCCR1A=0x00;TCCR1B=0x05;TCNT1H=0xC2;TCNT1L=0xF7;ICR1H=0x00;ICR1L=0x00;OCR1AH=0x00;OCR1AL=0x00;OCR1BH=0x00;OCR1BL=0x00;OCR1CH=0x00;OCR1CL=0x00;// Timer(s)/Counter(s) Interrupt(s) initializationTIMSK=0x04;ETIMSK=0x00;// USART0 initialization// Communication Parameters: 8 Data, 1 Stop, No Parity// USART0 Receiver: Off// USART0 Transmitter: On// USART0 Mode: Asynchronous// USART0 Baud Rate: 9600UCSR0A=0x00;UCSR0B=0x08;UCSR0C=0x06;UBRR0H=0x00;UBRR0L=0x67;// Analog Comparator initialization// Analog Comparator: Off// Analog Comparator Input Capture by Timer/Counter 1: OffACSR=0x80;SFIOR=0x00;// ADC initialization// ADC Clock frequency: 1000,000 kHz// ADC Voltage Reference: AREF pinADMUX=ADC_VREF_TYPE &amp; 0xff;ADCSRA=0x84;// Global enable interrupts#asm(&quot;sei&quot;)Init();while (1)      {        ReadFreq(freq);                for (i=0;i&lt;7;i++) {           printf(&quot;%d&quot;,freq[i]-100);           if(i&lt;6) printf(&quot;, &quot;);           else printf(&quot;\r\n&quot;);        }                delay_ms(20);      };}</span></code></pre>
<p>NOTE: This code contributed by forum member Pandora.<br /><br /><br /><a href="image:nextredirectltr.png" title="wikilink">image:nextredirectltr.pngGo</a> Shopping <a href="https://www.dfrobot.com/product-514.html">Audio Analyzer</a>Category: <a href="https://www.dfrobot.com/">DFRobot</a> &gt; <a href="https://www.dfrobot.com/category-156.html">Sensors &amp; Modules</a> &gt; <a href="https://www.dfrobot.com/category-36.html">Sensors</a> &gt; <a href="https://www.dfrobot.com/category-76.html">Interactive Sensors</a><a href="category:_Product_Manual" title="wikilink">category: Product Manual</a><a href="category:_DFR_Series" title="wikilink">category: DFR Series</a><a href="category:_Modules" title="wikilink">category: Modules</a><a href="category:_source" title="wikilink">category: source</a><a href="category:_Diagram" title="wikilink">category: Diagram</a></p>---
title: Audio Analyzer (SKU:DFR0126)
permalink: /Audio_Analyzer_(SKU:DFR0126)/
---

